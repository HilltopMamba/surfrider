{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "## Eman's solution for merging data in python"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "## Import dependencies; already installed pip.py for xlrd\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Row ID Order Priority  Discount  Unit Price  Shipping Cost  Customer ID  \\\n",
      "0      18606  Not Specified      0.01        2.88           0.50            2   \n",
      "1      20847           High      0.01        2.84           0.93            3   \n",
      "2      23086  Not Specified      0.03        6.68           6.15            3   \n",
      "3      23087  Not Specified      0.01        5.68           3.60            3   \n",
      "4      23088  Not Specified      0.00      205.99           2.50            3   \n",
      "...      ...            ...       ...         ...            ...          ...   \n",
      "9421   20275       Critical      0.06       35.89          14.72         3402   \n",
      "9422   20276       Critical      0.00        3.34           7.49         3402   \n",
      "9423   24491  Not Specified      0.08      550.98          45.70         3402   \n",
      "9424   25914           High      0.10      105.98          13.99         3403   \n",
      "9425   24492  Not Specified      0.09        7.78           2.50         3403   \n",
      "\n",
      "        Customer Name       Ship Mode Customer Segment Product Category  ...  \\\n",
      "0     Janice Fletcher     Regular Air        Corporate  Office Supplies  ...   \n",
      "1       Bonnie Potter     Express Air        Corporate  Office Supplies  ...   \n",
      "2       Bonnie Potter     Express Air        Corporate  Office Supplies  ...   \n",
      "3       Bonnie Potter     Regular Air        Corporate  Office Supplies  ...   \n",
      "4       Bonnie Potter     Express Air        Corporate       Technology  ...   \n",
      "...               ...             ...              ...              ...  ...   \n",
      "9421   Frederick Cole     Regular Air         Consumer  Office Supplies  ...   \n",
      "9422   Frederick Cole     Regular Air         Consumer  Office Supplies  ...   \n",
      "9423   Frederick Cole  Delivery Truck         Consumer        Furniture  ...   \n",
      "9424    Tammy Buckley     Express Air         Consumer        Furniture  ...   \n",
      "9425    Tammy Buckley     Express Air         Consumer  Office Supplies  ...   \n",
      "\n",
      "       Region State or Province        City  Postal Code Order Date  \\\n",
      "0     Central          Illinois     Addison        60101 2012-05-28   \n",
      "1        West        Washington   Anacortes        98221 2010-07-07   \n",
      "2        West        Washington   Anacortes        98221 2011-07-27   \n",
      "3        West        Washington   Anacortes        98221 2011-07-27   \n",
      "4        West        Washington   Anacortes        98221 2011-07-27   \n",
      "...       ...               ...         ...          ...        ...   \n",
      "9421     East     West Virginia  Charleston        25314 2013-05-14   \n",
      "9422     East     West Virginia  Charleston        25314 2013-05-14   \n",
      "9423     East     West Virginia  Charleston        25314 2013-09-12   \n",
      "9424     West           Wyoming    Cheyenne        82001 2010-02-08   \n",
      "9425     West           Wyoming    Cheyenne        82001 2013-09-12   \n",
      "\n",
      "      Ship Date       Profit  Quantity ordered new    Sales Order ID  \n",
      "0    2012-05-30     1.320000                     2     5.90    88525  \n",
      "1    2010-07-08     4.560000                     4    13.01    88522  \n",
      "2    2011-07-28   -47.640000                     7    49.92    88523  \n",
      "3    2011-07-28   -30.510000                     7    41.64    88523  \n",
      "4    2011-07-27   998.202300                     8  1446.67    88523  \n",
      "...         ...          ...                   ...      ...      ...  \n",
      "9421 2013-05-15   137.860000                    13   447.87    87532  \n",
      "9422 2013-05-14   -39.070000                     3    13.23    87532  \n",
      "9423 2013-09-14 -1225.029097                     4  2215.93    87533  \n",
      "9424 2010-02-11   349.485000                     5   506.50    87530  \n",
      "9425 2013-09-14    78.062400                    23   172.48    87533  \n",
      "\n",
      "[9426 rows x 24 columns]\n"
     ]
    }
   ],
   "source": [
    "#Get Orders sheet from Superstore xls\n",
    "df_orders = pd.read_excel(r'C:\\Users\\lenovo\\Desktop\\Superstore.xlsx', sheet_name=0)\n",
    "print (df_orders)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      Row ID Order Priority  Discount  Unit Price  Shipping Cost  Customer ID  \\\n",
      "0      18606  Not Specified      0.01        2.88           0.50            2   \n",
      "1      20847           High      0.01        2.84           0.93            3   \n",
      "2      23086  Not Specified      0.03        6.68           6.15            3   \n",
      "3      23087  Not Specified      0.01        5.68           3.60            3   \n",
      "4      23088  Not Specified      0.00      205.99           2.50            3   \n",
      "...      ...            ...       ...         ...            ...          ...   \n",
      "9421   20275       Critical      0.06       35.89          14.72         3402   \n",
      "9422   20276       Critical      0.00        3.34           7.49         3402   \n",
      "9423   24491  Not Specified      0.08      550.98          45.70         3402   \n",
      "9424   25914           High      0.10      105.98          13.99         3403   \n",
      "9425   24492  Not Specified      0.09        7.78           2.50         3403   \n",
      "\n",
      "        Customer Name       Ship Mode Customer Segment Product Category  ...  \\\n",
      "0     Janice Fletcher     Regular Air        Corporate  Office Supplies  ...   \n",
      "1       Bonnie Potter     Express Air        Corporate  Office Supplies  ...   \n",
      "2       Bonnie Potter     Express Air        Corporate  Office Supplies  ...   \n",
      "3       Bonnie Potter     Regular Air        Corporate  Office Supplies  ...   \n",
      "4       Bonnie Potter     Express Air        Corporate       Technology  ...   \n",
      "...               ...             ...              ...              ...  ...   \n",
      "9421   Frederick Cole     Regular Air         Consumer  Office Supplies  ...   \n",
      "9422   Frederick Cole     Regular Air         Consumer  Office Supplies  ...   \n",
      "9423   Frederick Cole  Delivery Truck         Consumer        Furniture  ...   \n",
      "9424    Tammy Buckley     Express Air         Consumer        Furniture  ...   \n",
      "9425    Tammy Buckley     Express Air         Consumer  Office Supplies  ...   \n",
      "\n",
      "       Region State or Province        City  Postal Code Order Date  \\\n",
      "0     Central          Illinois     Addison        60101 2012-05-28   \n",
      "1        West        Washington   Anacortes        98221 2010-07-07   \n",
      "2        West        Washington   Anacortes        98221 2011-07-27   \n",
      "3        West        Washington   Anacortes        98221 2011-07-27   \n",
      "4        West        Washington   Anacortes        98221 2011-07-27   \n",
      "...       ...               ...         ...          ...        ...   \n",
      "9421     East     West Virginia  Charleston        25314 2013-05-14   \n",
      "9422     East     West Virginia  Charleston        25314 2013-05-14   \n",
      "9423     East     West Virginia  Charleston        25314 2013-09-12   \n",
      "9424     West           Wyoming    Cheyenne        82001 2010-02-08   \n",
      "9425     West           Wyoming    Cheyenne        82001 2013-09-12   \n",
      "\n",
      "      Ship Date       Profit  Quantity ordered new    Sales Order ID  \n",
      "0    2012-05-30     1.320000                     2     5.90    88525  \n",
      "1    2010-07-08     4.560000                     4    13.01    88522  \n",
      "2    2011-07-28   -47.640000                     7    49.92    88523  \n",
      "3    2011-07-28   -30.510000                     7    41.64    88523  \n",
      "4    2011-07-27   998.202300                     8  1446.67    88523  \n",
      "...         ...          ...                   ...      ...      ...  \n",
      "9421 2013-05-15   137.860000                    13   447.87    87532  \n",
      "9422 2013-05-14   -39.070000                     3    13.23    87532  \n",
      "9423 2013-09-14 -1225.029097                     4  2215.93    87533  \n",
      "9424 2010-02-11   349.485000                     5   506.50    87530  \n",
      "9425 2013-09-14    78.062400                    23   172.48    87533  \n",
      "\n",
      "[9426 rows x 24 columns]\n"
     ]
    }
   ],
   "source": [
    "#Get Returns sheet from Superstore xls\n",
    "df_returns = pd.read_excel(r'C:\\Users\\lenovo\\Desktop\\Superstore.xlsx', sheet_name=1)\n",
    "print (df_orders)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "    Row ID Order Priority  Discount  Unit Price  Shipping Cost  Customer ID  \\\n",
      "0     1359            Low      0.05        5.85           2.27           21   \n",
      "1     1950         Medium      0.01        4.91           0.50          117   \n",
      "2     1951         Medium      0.09        4.00           1.30          117   \n",
      "3     5055           High      0.02        3.28           5.00          117   \n",
      "4     5573            Low      0.02       11.97           5.81          272   \n",
      "..     ...            ...       ...         ...            ...          ...   \n",
      "93     986  Not Specified      0.06       37.94           5.08         3075   \n",
      "94     987  Not Specified      0.10       55.29           5.08         3075   \n",
      "95    6041         Medium      0.05        4.28           6.18         3075   \n",
      "96    1910           High      0.05       14.48           1.99         3079   \n",
      "97    6625           High      0.06      128.24          12.65         3251   \n",
      "\n",
      "           Customer Name    Ship Mode Customer Segment Product Category  ...  \\\n",
      "0   Tony Wilkins Winters  Regular Air   Small Business  Office Supplies  ...   \n",
      "1            Linda Weiss  Regular Air      Home Office  Office Supplies  ...   \n",
      "2            Linda Weiss  Express Air      Home Office  Office Supplies  ...   \n",
      "3            Linda Weiss  Regular Air      Home Office  Office Supplies  ...   \n",
      "4          Eleanor Swain  Regular Air   Small Business  Office Supplies  ...   \n",
      "..                   ...          ...              ...              ...  ...   \n",
      "93         Gordon Brandt  Regular Air        Corporate  Office Supplies  ...   \n",
      "94         Gordon Brandt  Regular Air        Corporate  Office Supplies  ...   \n",
      "95         Gordon Brandt  Express Air        Corporate  Office Supplies  ...   \n",
      "96         Andrew Levine  Regular Air         Consumer       Technology  ...   \n",
      "97          Peter Brooks  Regular Air   Small Business        Furniture  ...   \n",
      "\n",
      "   State or Province           City Postal Code  Order Date  Ship Date  \\\n",
      "0           New York  New York City       10012  2011-04-20 2011-04-24   \n",
      "1         Washington        Seattle       98103  2010-04-04 2010-04-06   \n",
      "2         Washington        Seattle       98103  2010-04-04 2010-04-06   \n",
      "3         Washington        Seattle       98103  2013-08-16 2013-08-18   \n",
      "4     North Carolina      Charlotte       28204  2013-08-12 2013-08-12   \n",
      "..               ...            ...         ...         ...        ...   \n",
      "93        California    Los Angeles       90061  2013-01-04 2013-01-06   \n",
      "94        California    Los Angeles       90061  2013-01-04 2013-01-05   \n",
      "95        California    Los Angeles       90061  2013-06-25 2013-06-27   \n",
      "96      Pennsylvania   Philadelphia       19112  2012-09-30 2012-10-02   \n",
      "97          New York  New York City       10112  2012-09-11 2012-09-13   \n",
      "\n",
      "       Profit Quantity ordered new     Sales Order ID    Status  \n",
      "0     -6.8200                    9     54.79     9895  Returned  \n",
      "1    112.0600                   47    228.46    13959  Returned  \n",
      "2     16.7900                   19     77.61    13959  Returned  \n",
      "3    -89.0600                   52    190.52    36038  Returned  \n",
      "4    -81.9413                   76    912.06    39490  Returned  \n",
      "..        ...                  ...       ...      ...       ...  \n",
      "93   -33.9680                    3    113.14     7107  Returned  \n",
      "94   163.1200                   35   1886.52     7107  Returned  \n",
      "95   -22.5600                   12     73.71    42823  Returned  \n",
      "96   165.2000                   96   1337.67    13638  Returned  \n",
      "97  1844.9600                   92  12002.16    47109  Returned  \n",
      "\n",
      "[98 rows x 25 columns]\n"
     ]
    }
   ],
   "source": [
    "## Join Orders and Returns from Superstore xlsx on OrderID\n",
    "df_join = df_orders.merge(df_returns,on='Order ID')\n",
    "print (df_join)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Output merged data back to MS Excel\n",
    "# Set index to false so that the parameter index column does not get saved\n",
    "df_join.to_excel(r'C:\\Users\\lenovo\\Desktop\\Superstore_Final_df.xlsx',index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
